import{c as o,a as c}from"./redux-BWM5Hhun.js";import{a as d}from"./cart-BewrXa47.js";const g={profile:null,loading:!1,error:null,updateLoading:!1,deleteLoading:!1,addressLoading:!1},n=o("user/fetchProfile",async(a,{rejectWithValue:e})=>{try{return(await d.get("https://furnishly.online/api/users/profile",{withCredentials:!0})).data.data}catch(r){return d.isAxiosError(r)?e(r.response?.data?.message||"Failed to fetch profile"):e(r instanceof Error?r.message:"Failed to fetch profile")}}),p=o("user/updateProfile",async(a,{rejectWithValue:e})=>{try{return(await d.put("https://furnishly.online/api/users/profile",a,{headers:{"Content-Type":"application/json"},withCredentials:!0})).data.data}catch(r){if(d.isAxiosError(r)){const s=r.response?.data?.message||"Failed to update profile";return e(s)}return e(r instanceof Error?r.message:"Failed to update profile")}}),i=o("user/addAddress",async(a,{rejectWithValue:e})=>{try{return(await d.post("https://furnishly.online/api/users/addresses",a,{headers:{"Content-Type":"application/json"},withCredentials:!0})).data.data}catch(r){return d.isAxiosError(r)?e(r.response?.data?.message||"Failed to add address"):e(r instanceof Error?r.message:"Failed to add address")}}),l=o("user/updateAddress",async({addressId:a,address:e},{rejectWithValue:r})=>{try{return(await d.put(`https://furnishly.online/api/users/addresses/${a}`,e,{headers:{"Content-Type":"application/json"},withCredentials:!0})).data.data}catch(s){return d.isAxiosError(s)?r(s.response?.data?.message||"Failed to update address"):r(s instanceof Error?s.message:"Failed to update address")}}),t=o("user/deleteAccount",async(a,{rejectWithValue:e})=>{try{return(await d.delete("https://furnishly.online/api/users/profile",{withCredentials:!0})).data}catch(r){return d.isAxiosError(r)?e(r.response?.data?.message||"Failed to delete account"):e(r instanceof Error?r.message:"Failed to delete account")}}),u=c({name:"user",initialState:g,reducers:{clearError:a=>{a.error=null},clearProfile:a=>{a.profile=null,a.error=null}},extraReducers:a=>{a.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,r)=>{e.loading=!1,e.profile=r.payload}).addCase(n.rejected,(e,r)=>{e.loading=!1,e.error=r.payload}).addCase(p.pending,e=>{e.updateLoading=!0,e.error=null}).addCase(p.fulfilled,e=>{e.updateLoading=!1}).addCase(i.pending,e=>{e.addressLoading=!0,e.error=null}).addCase(i.fulfilled,(e,r)=>{e.addressLoading=!1,e.profile&&(e.profile.addresses=[r.payload])}).addCase(i.rejected,(e,r)=>{e.addressLoading=!1,e.error=r.payload}).addCase(l.pending,e=>{e.addressLoading=!0,e.error=null}).addCase(l.fulfilled,(e,r)=>{if(e.addressLoading=!1,e.profile){const s=e.profile.addresses.findIndex(f=>f._id===r.payload._id);s!==-1&&(e.profile.addresses[s]=r.payload)}}).addCase(l.rejected,(e,r)=>{e.addressLoading=!1,e.error=r.payload}).addCase(t.pending,e=>{e.deleteLoading=!0,e.error=null}).addCase(t.fulfilled,e=>{e.deleteLoading=!1,e.profile=null}).addCase(t.rejected,(e,r)=>{e.deleteLoading=!1,e.error=r.payload})}}),{clearError:C,clearProfile:m}=u.actions,L=u.reducer;export{l as a,i as b,m as c,L as u};
